{"ast":null,"code":"// <scriptSig> {serialized scriptPubKey script}\nvar bscript = require('../../script');\n\nvar types = require('../../types');\n\nvar typeforce = require('typeforce');\n\nvar p2ms = require('../multisig/');\n\nvar p2pk = require('../pubkey/');\n\nvar p2pkh = require('../pubkeyhash/');\n\nfunction check(chunks, allowIncomplete) {\n  typeforce(types.Array, chunks);\n  if (chunks.length < 1) return false;\n  var witnessScript = chunks[chunks.length - 1];\n  if (!Buffer.isBuffer(witnessScript)) return false;\n  var witnessScriptChunks = bscript.decompile(witnessScript); // is witnessScript a valid script?\n\n  if (!witnessScriptChunks || witnessScriptChunks.length === 0) return false;\n  var witnessRawScriptSig = bscript.compile(chunks.slice(0, -1)); // match types\n\n  if (p2pkh.input.check(witnessRawScriptSig) && p2pkh.output.check(witnessScriptChunks)) return true;\n  if (p2ms.input.check(witnessRawScriptSig, allowIncomplete) && p2ms.output.check(witnessScriptChunks)) return true;\n  if (p2pk.input.check(witnessRawScriptSig) && p2pk.output.check(witnessScriptChunks)) return true;\n  return false;\n}\n\ncheck.toJSON = function () {\n  return 'witnessScriptHash input';\n};\n\nmodule.exports = {\n  check: check\n};","map":null,"metadata":{},"sourceType":"script"}