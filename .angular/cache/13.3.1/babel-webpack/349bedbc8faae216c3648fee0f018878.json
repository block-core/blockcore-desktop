{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { TransactionBuilding } from '../../../classes/transaction-building';\nimport { debounceTime } from 'rxjs/operators';\nimport { CoinNotationPipe } from '../../../shared/pipes/coin-notation.pipe';\nimport { FeeEstimation } from '../../../classes/fee-estimation';\nimport { TransactionSending } from '../../../classes/transaction-sending';\nimport { WalletInfo } from '../../../classes/wallet-info';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/application-state.service\";\nimport * as i2 from \"src/app/shared/app-modes\";\nimport * as i3 from \"../../../services/api.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"../../../services/wallet.service\";\nimport * as i7 from \"../../../services/global.service\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/material/card\";\nimport * as i10 from \"@angular/material/form-field\";\nimport * as i11 from \"@angular/material/input\";\nimport * as i12 from \"@angular/material/icon\";\nimport * as i13 from \"@angular/material/expansion\";\nimport * as i14 from \"@angular/material/checkbox\";\nimport * as i15 from \"@angular/material/button\";\nimport * as i16 from \"@angular/material/progress-spinner\";\nimport * as i17 from \"../../../shared/pipes/coin-notation.pipe\";\n\nfunction SendComponent_h1_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, ctx_r0.appState.appTitle$));\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_error_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.formErrors.amount, \" \");\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.formErrors.address, \" \");\n  }\n}\n\nfunction SendComponent_mat_card_8_label_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 17);\n    i0.ɵɵtext(1, \"Please enter a valid amount and destination address to calculate the fee.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SendComponent_mat_card_8_label_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"coinNotation\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(2, 2, ctx_r7.estimatedFee), \" \", ctx_r7.coinUnit, \"\");\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_error_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r8.formErrors.password, \" \");\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_accordion_31_mat_error_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r12.formErrors.opreturndata, \" \");\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_accordion_31_mat_error_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r13.formErrors.opreturnamount, \" \");\n  }\n}\n\nfunction SendComponent_mat_card_8_mat_accordion_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-accordion\", 19)(1, \"mat-expansion-panel\")(2, \"mat-expansion-panel-header\")(3, \"mat-panel-title\");\n    i0.ɵɵtext(4, \" Options \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"mat-panel-description\");\n    i0.ɵɵtext(6, \" \\u00A0 \");\n    i0.ɵɵelementStart(7, \"mat-icon\");\n    i0.ɵɵtext(8, \"text_snippet\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"h3\", 20);\n    i0.ɵɵtext(10, \"Add message to transaction\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"mat-form-field\", 6)(12, \"mat-label\");\n    i0.ɵɵtext(13, \"OP_RETURN (message)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"input\", 21, 22);\n    i0.ɵɵelementStart(16, \"mat-hint\", 23)(17, \"strong\");\n    i0.ɵɵtext(18, \"Don't disclose personal info. Permanently stored on blockchain.\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"mat-hint\", 24);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"mat-icon\", 8);\n    i0.ɵɵtext(22, \"book\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(23, SendComponent_mat_card_8_mat_accordion_31_mat_error_23_Template, 2, 1, \"mat-error\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(24, \"br\")(25, \"br\");\n    i0.ɵɵelementStart(26, \"h3\", 20);\n    i0.ɵɵtext(27, \"Burn amount:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"mat-form-field\", 6)(29, \"mat-label\");\n    i0.ɵɵtext(30, \"Burn amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(31, \"input\", 25);\n    i0.ɵɵelementStart(32, \"mat-hint\", 23)(33, \"strong\");\n    i0.ɵɵtext(34, \"Makes coins unusable. They can never be restored.\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(35, \"mat-icon\", 8);\n    i0.ɵɵtext(36, \"account_balance_wallet\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(37, SendComponent_mat_card_8_mat_accordion_31_mat_error_37_Template, 2, 1, \"mat-error\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(38, \"br\")(39, \"br\");\n    i0.ɵɵelementStart(40, \"h3\", 20);\n    i0.ɵɵtext(41, \"Additional options:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"mat-checkbox\", 26);\n    i0.ɵɵtext(43, \"Shuffle outputs (increase privacy)\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const _r11 = i0.ɵɵreference(15);\n\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"maxlength\", ctx_r9.appState.activeChain.opreturndata);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate2(\"\", _r11.value.length, \" / \", ctx_r9.appState.activeChain.opreturndata, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.formErrors.opreturndata);\n    i0.ɵɵadvance(8);\n    i0.ɵɵpropertyInterpolate1(\"placeholder\", \"0.00 \", ctx_r9.coinUnit, \"\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.formErrors.opreturnamount);\n  }\n}\n\nfunction SendComponent_mat_card_8_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r10.apiError);\n  }\n}\n\nfunction SendComponent_mat_card_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card\")(1, \"form\", 5)(2, \"mat-form-field\", 6)(3, \"mat-label\");\n    i0.ɵɵtext(4, \"Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"input\", 7);\n    i0.ɵɵelementStart(6, \"mat-icon\", 8);\n    i0.ɵɵtext(7, \"account_balance_wallet\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, SendComponent_mat_card_8_mat_error_8_Template, 2, 1, \"mat-error\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"br\");\n    i0.ɵɵelementStart(10, \"mat-form-field\", 6)(11, \"mat-label\");\n    i0.ɵɵtext(12, \"Destination address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"input\", 9);\n    i0.ɵɵelementStart(14, \"mat-icon\", 8);\n    i0.ɵɵtext(15, \"book\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(16, SendComponent_mat_card_8_mat_error_16_Template, 2, 1, \"mat-error\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(17, \"br\");\n    i0.ɵɵelementStart(18, \"label\");\n    i0.ɵɵtext(19, \"Transaction Fee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"div\");\n    i0.ɵɵtemplate(21, SendComponent_mat_card_8_label_21_Template, 2, 0, \"label\", 10);\n    i0.ɵɵtemplate(22, SendComponent_mat_card_8_label_22_Template, 3, 4, \"label\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(23, \"br\");\n    i0.ɵɵelementStart(24, \"mat-form-field\", 6)(25, \"mat-label\");\n    i0.ɵɵtext(26, \"Wallet Password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(27, \"input\", 12);\n    i0.ɵɵelementStart(28, \"mat-icon\", 8);\n    i0.ɵɵtext(29, \"lock\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(30, SendComponent_mat_card_8_mat_error_30_Template, 2, 1, \"mat-error\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(31, SendComponent_mat_card_8_mat_accordion_31_Template, 44, 6, \"mat-accordion\", 13);\n    i0.ɵɵelement(32, \"br\");\n    i0.ɵɵtemplate(33, SendComponent_mat_card_8_div_33_Template, 2, 1, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function SendComponent_mat_card_8_Template_button_click_34_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.send();\n    });\n    i0.ɵɵtext(35, \"Send\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(36, \"\\u00A0 \");\n    i0.ɵɵelementStart(37, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function SendComponent_mat_card_8_Template_button_click_37_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.cancel();\n    });\n    i0.ɵɵtext(38, \"Cancel\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.sendForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"placeholder\", \"0.00 \", ctx_r1.coinUnit, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.formErrors.amount);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.formErrors.address);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.estimatedFee);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.estimatedFee);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.formErrors.password);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.appModes.enabled(\"send-options\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.apiError);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r1.sendForm.valid || ctx_r1.isSending || ctx_r1.estimatedFee === null);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.isSending);\n  }\n}\n\nfunction SendComponent_mat_card_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-card\")(1, \"div\", 28);\n    i0.ɵɵelement(2, \"mat-spinner\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" \\u00A0\\u00A0 Sending transaction ... \");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"diameter\", 24);\n  }\n}\n\nfunction SendComponent_mat_card_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card\")(1, \"h1\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"number\");\n    i0.ɵɵelementStart(4, \"small\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"number\");\n    i0.ɵɵelementStart(9, \"small\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"p\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function SendComponent_mat_card_10_Template_button_click_15_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.cancel();\n    });\n    i0.ɵɵtext(16, \"Close\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Sent: \", i0.ɵɵpipeBind2(3, 6, ctx_r3.transaction.recipients[0].amount, \"1.8-8\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r3.coinUnit);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fee: \", i0.ɵɵpipeBind2(8, 9, ctx_r3.transaction.feeAmount, \"1.8-8\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r3.coinUnit);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Destination: \", ctx_r3.transaction.recipients[0].destinationAddress, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Transaction Id: \", ctx_r3.transactionResult.transactionId, \"\");\n  }\n}\n\nexport class SendComponent {\n  appState;\n  appModes;\n  apiService;\n  location;\n  router;\n  wallet;\n  globalService;\n  fb;\n  hostClass = true;\n  sendForm;\n  coinUnit;\n  isSending = false;\n  estimatedFee = 0;\n  totalBalance = 0;\n  apiError;\n  transactionResult;\n  transaction;\n  showInputField = true;\n  showSendingField = false;\n  showConfirmationField = false;\n  transactionHex;\n  responseMessage;\n  errorMessage;\n  walletBalanceSubscription;\n\n  constructor(appState, appModes, apiService, location, router, wallet, globalService, fb) {\n    this.appState = appState;\n    this.appModes = appModes;\n    this.apiService = apiService;\n    this.location = location;\n    this.router = router;\n    this.wallet = wallet;\n    this.globalService = globalService;\n    this.fb = fb;\n    this.appState.pageMode = true;\n    this.buildSendForm();\n  }\n\n  ngOnInit() {\n    this.startSubscriptions();\n    this.coinUnit = this.globalService.getCoinUnit();\n  }\n\n  ngOnDestroy() {\n    this.appState.pageMode = false;\n    this.cancelSubscriptions();\n  } // eslint-disable-next-line @typescript-eslint/member-ordering\n\n\n  formErrors = {\n    address: '',\n    amount: '',\n    fee: '',\n    password: '',\n    opreturndata: '',\n    opreturnamount: ''\n  }; // eslint-disable-next-line @typescript-eslint/member-ordering\n\n  validationMessages = {\n    address: {\n      required: 'An address is required.',\n      minlength: 'An address is at least 26 characters long.'\n    },\n    amount: {\n      required: 'An amount is required.',\n      pattern: 'Enter a valid transaction amount. Only positive numbers and no more than 8 decimals are allowed.',\n      min: 'The amount has to be more or equal to 0.00001 City.',\n      max: 'The total transaction amount exceeds your available balance.'\n    },\n    fee: {\n      required: 'A fee is required.'\n    },\n    password: {\n      required: 'Your password is required.'\n    },\n    opreturndata: {\n      max: 'Maximum 80 characters.'\n    },\n    opreturnamount: {\n      pattern: 'Enter a valid amount. Only positive numbers and no more than 8 decimals are allowed.'\n    }\n  };\n\n  buildSendForm() {\n    this.sendForm = this.fb.group({\n      address: ['', Validators.compose([Validators.required, Validators.minLength(26)])],\n      amount: ['', Validators.compose([Validators.required, Validators.pattern(/^([0-9]+)?(\\.[0-9]{0,8})?$/), Validators.min(0.00001), control => Validators.max((this.totalBalance - this.estimatedFee) / 100000000)(control)])],\n      fee: ['medium', Validators.required],\n      password: ['', Validators.required],\n      shuffleOutputs: [true],\n      opreturndata: ['', Validators.compose([Validators.maxLength(this.appState.activeChain.opreturndata)])],\n      opreturnamount: ['', Validators.compose([Validators.pattern(/^([0-9]+)?(\\.[0-9]{0,8})?$/)])]\n    });\n    this.sendForm.valueChanges.pipe(debounceTime(300)).subscribe(data => this.onValueChanged(data));\n  }\n\n  cancel() {\n    this.isSending = false;\n    this.location.back();\n  }\n\n  onValueChanged(data) {\n    if (!this.sendForm) {\n      return;\n    }\n\n    const form = this.sendForm; // eslint-disable-next-line guard-for-in\n\n    for (const field in this.formErrors) {\n      this.formErrors[field] = '';\n      const control = form.get(field);\n\n      if (control && control.dirty && !control.valid) {\n        const messages = this.validationMessages[field]; // eslint-disable-next-line guard-for-in\n\n        for (const key in control.errors) {\n          this.formErrors[field] += messages[key] + ' ';\n        }\n      }\n    }\n\n    this.apiError = '';\n\n    if (this.sendForm.get('address').valid && this.sendForm.get('amount').valid) {\n      this.estimateFee();\n    }\n  }\n\n  getMaxBalance() {\n    const data = {\n      walletName: this.globalService.getWalletName(),\n      accontName: 'account 0',\n      feeType: this.sendForm.get('fee').value\n    };\n    let balanceResponse;\n    this.apiService.getMaximumBalance(data).subscribe(response => {\n      // if (response.status >= 200 && response.status < 400) {\n      balanceResponse = response; // }\n    }, error => {\n      console.log(error);\n\n      if (error.status === 0) {\n        // this.genericModalService.openModal(null, null);\n        this.apiError = 'Something went wrong while connecting to the API. Please restart the application.';\n      } else if (error.status >= 400) {\n        this.apiService.handleException(error);\n\n        if (!error.error.errors[0]) {} else {\n          this.apiError = error.error.errors[0].message;\n        }\n      }\n    }, () => {\n      this.sendForm.patchValue({\n        amount: +new CoinNotationPipe(this.globalService).transform(balanceResponse.maxSpendableAmount)\n      });\n      this.estimatedFee = balanceResponse.fee;\n    });\n  }\n\n  estimateFee() {\n    const transaction = new FeeEstimation(this.globalService.getWalletName(), 'account 0', this.sendForm.get('address').value.trim(), this.sendForm.get('amount').value, this.sendForm.get('fee').value, true, this.sendForm.get('opreturndata').value, this.sendForm.get('opreturnamount').value);\n    this.apiService.estimateFee(transaction).subscribe(response => {\n      // if (response.status >= 200 && response.status < 400) {\n      this.responseMessage = response; // }\n    }, error => {\n      console.log(error);\n\n      if (error.status === 0) {// this.genericModalService.openModal(null, null);\n      } else if (error.status >= 400) {\n        this.apiService.handleException(error);\n\n        if (!error.error.errors[0]) {\n          this.apiError = error;\n        } else {\n          // this.genericModalService.openModal(null, error.json().errors[0].message);\n          this.apiError = error.error.errors[0].message;\n        }\n      }\n    }, () => {\n      this.estimatedFee = this.responseMessage;\n    });\n  }\n\n  buildTransaction() {\n    this.transaction = new TransactionBuilding(this.globalService.getWalletName(), 'account 0', this.sendForm.get('password').value, this.sendForm.get('address').value.trim(), this.sendForm.get('amount').value, this.sendForm.get('fee').value, // TO DO: use coin notation\n    this.estimatedFee / 100000000, true, this.sendForm.get('shuffleOutputs').value, this.wallet.isSingleAddressMode, this.sendForm.get('opreturndata').value, this.sendForm.get('opreturnamount').value);\n    this.apiService.buildTransaction(this.transaction).subscribe(response => {\n      // if (response.status >= 200 && response.status < 400) {\n      console.log(response);\n      this.responseMessage = response; // }\n    }, error => {\n      console.log(error);\n      this.isSending = false;\n      this.showInputField = true;\n      this.showConfirmationField = false;\n      this.showSendingField = false;\n\n      if (error.status === 0) {\n        // this.genericModalService.openModal(null, null);\n        this.apiError = 'Something went wrong while connecting to the API. Please restart the application.';\n      } else if (error.status >= 400) {\n        this.apiService.handleException(error);\n\n        if (!error.error.errors[0]) {} else {\n          // this.genericModalService.openModal(null, error.json().errors[0].message);\n          this.apiError = error.error.errors[0].message;\n        }\n      }\n    }, () => {\n      this.estimatedFee = this.responseMessage.fee;\n      this.transactionHex = this.responseMessage.hex;\n\n      if (this.isSending) {\n        this.sendTransaction(this.transactionHex);\n      }\n    });\n  }\n\n  send() {\n    this.isSending = true;\n    this.showInputField = false;\n    this.showConfirmationField = false;\n    this.showSendingField = true;\n    this.buildTransaction();\n  }\n\n  sendTransaction(hex) {\n    const transaction = new TransactionSending(hex);\n    this.apiService.sendTransaction(transaction).subscribe(response => {\n      this.transactionResult = response;\n    }, error => {\n      console.log(error);\n      this.isSending = false;\n\n      if (error.status === 0) {\n        // this.genericModalService.openModal(null, null);\n        this.apiError = 'Something went wrong while connecting to the API. Please restart the application.';\n      } else if (error.status >= 400) {\n        this.apiService.handleException(error);\n\n        if (!error.error.errors[0]) {} else {\n          // this.genericModalService.openModal(null, error.json().errors[0].message);\n          this.apiError = error.error.errors[0].message;\n        }\n      }\n    }, () => this.openConfirmationModal());\n  }\n\n  getWalletBalance() {\n    const walletInfo = new WalletInfo(this.globalService.getWalletName());\n    this.walletBalanceSubscription = this.apiService.getWalletBalance(walletInfo).subscribe(response => {\n      // if (response.status >= 200 && response.status < 400) {\n      const balanceResponse = response; // TO DO - add account feature instead of using first entry in array\n\n      this.totalBalance = balanceResponse.balances[0].amountConfirmed + balanceResponse.balances[0].amountUnconfirmed; // }\n    }, error => {\n      console.log(error);\n\n      if (error.status === 0) {// We used to cancelSubscription here, not a good idea if it fails the first time.\n        // this.cancelSubscriptions();\n        // this.genericModalService.openModal(null, null);\n      } else if (error.status >= 400) {\n        this.apiService.handleException(error);\n\n        if (!error.error.errors[0]) {} else {\n          if (error.error.errors[0].description) {// this.genericModalService.openModal(null, error.json().errors[0].message);\n          } else {\n            this.cancelSubscriptions();\n            this.startSubscriptions();\n          }\n        }\n      }\n    });\n  } // public get sentAmount(): number {\n  //     return Number(this.transaction.amount);\n  // }\n\n\n  openConfirmationModal() {\n    console.log('Show confirmation TX: ', this.transaction);\n    console.log('Show confirmation FEE: ', this.estimatedFee);\n    this.showSendingField = false;\n    this.showConfirmationField = true; // const modalRef = this.modalService.open(SendConfirmationComponent, { backdrop: \"static\" });\n    // modalRef.componentInstance.transaction = this.transaction;\n    // modalRef.componentInstance.transactionFee = this.estimatedFee;\n  }\n\n  cancelSubscriptions() {\n    if (this.walletBalanceSubscription) {\n      this.walletBalanceSubscription.unsubscribe();\n    }\n  }\n\n  startSubscriptions() {\n    this.getWalletBalance();\n  }\n\n  static ɵfac = function SendComponent_Factory(t) {\n    return new (t || SendComponent)(i0.ɵɵdirectiveInject(i1.ApplicationStateService), i0.ɵɵdirectiveInject(i2.AppModes), i0.ɵɵdirectiveInject(i3.ApiService), i0.ɵɵdirectiveInject(i4.Location), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.WalletService), i0.ɵɵdirectiveInject(i7.GlobalService), i0.ɵɵdirectiveInject(i8.FormBuilder));\n  };\n  static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SendComponent,\n    selectors: [[\"app-send\"]],\n    hostVars: 2,\n    hostBindings: function SendComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        i0.ɵɵclassProp(\"send\", ctx.hostClass);\n      }\n    },\n    decls: 11,\n    vars: 8,\n    consts: [[1, \"content\", \"content-centered\"], [\"class\", \"mat-h1\", 4, \"ngIf\"], [1, \"mat-h2\"], [4, \"ngIf\"], [1, \"mat-h1\"], [3, \"formGroup\"], [\"appearance\", \"outline\"], [\"matInput\", \"\", \"id\", \"amount\", \"formControlName\", \"amount\", \"name\", \"amount\", 3, \"placeholder\"], [\"matSuffix\", \"\"], [\"matInput\", \"\", \"id\", \"destinationAddress\", \"formControlName\", \"address\", \"name\", \"address\", \"placeholder\", \"Please enter the destination address here.\"], [\"class\", \"blockText fee-error\", 4, \"ngIf\"], [\"class\", \"blockText\", 4, \"ngIf\"], [\"matInput\", \"\", \"type\", \"password\", \"id\", \"walletPassword\", \"formControlName\", \"password\", \"placeholder\", \"Please enter your wallet password.\"], [\"class\", \"example-headers-align\", 4, \"ngIf\"], [\"class\", \"send-error\", 4, \"ngIf\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"disabled\", \"click\"], [\"mat-stroked-button\", \"\", 3, \"disabled\", \"click\"], [1, \"blockText\", \"fee-error\"], [1, \"blockText\"], [1, \"example-headers-align\"], [1, \"mat-h3\"], [\"matInput\", \"\", \"id\", \"opreturndata\", \"formControlName\", \"opreturndata\", \"name\", \"opreturndata\", \"placeholder\", \"Enter a message here.\", 3, \"maxlength\"], [\"opreturndata\", \"\"], [\"align\", \"start\"], [\"align\", \"end\"], [\"matInput\", \"\", \"id\", \"opreturnamount\", \"formControlName\", \"opreturnamount\", \"name\", \"opreturnamount\", 3, \"placeholder\"], [\"formControlName\", \"shuffleOutputs\", \"name\", \"shuffleOutputs\"], [1, \"send-error\"], [1, \"spinner-container\"], [3, \"diameter\"], [\"mat-stroked-button\", \"\", 3, \"click\"]],\n    template: function SendComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, SendComponent_h1_1_Template, 3, 3, \"h1\", 1);\n        i0.ɵɵelementStart(2, \"mat-card\")(3, \"h2\", 2);\n        i0.ɵɵtext(4, \" Amount available: \");\n        i0.ɵɵelementStart(5, \"strong\");\n        i0.ɵɵtext(6);\n        i0.ɵɵpipe(7, \"coinNotation\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(8, SendComponent_mat_card_8_Template, 39, 11, \"mat-card\", 3);\n        i0.ɵɵtemplate(9, SendComponent_mat_card_9_Template, 4, 1, \"mat-card\", 3);\n        i0.ɵɵtemplate(10, SendComponent_mat_card_10_Template, 17, 12, \"mat-card\", 3);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.appState.handset);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(7, 6, ctx.totalBalance), \" \", ctx.coinUnit, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.showInputField);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showSendingField);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showConfirmationField);\n      }\n    },\n    directives: [i4.NgIf, i9.MatCard, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.FormGroupDirective, i10.MatFormField, i10.MatLabel, i11.MatInput, i8.DefaultValueAccessor, i8.NgControlStatus, i8.FormControlName, i12.MatIcon, i10.MatSuffix, i10.MatError, i13.MatAccordion, i13.MatExpansionPanel, i13.MatExpansionPanelHeader, i13.MatExpansionPanelTitle, i13.MatExpansionPanelDescription, i8.MaxLengthValidator, i10.MatHint, i14.MatCheckbox, i15.MatButton, i16.MatProgressSpinner],\n    pipes: [i4.AsyncPipe, i17.CoinNotationPipe, i4.DecimalPipe],\n    styles: [\".send .spinner-container {\\n  vertical-align: middle;\\n  display: inline-block;\\n}\\n.send .mat-form-field {\\n  width: 100%;\\n  max-width: 400px;\\n}\\n.send mat-card {\\n  margin-bottom: 20px;\\n}\\n.example-action-buttons {\\n  padding-bottom: 20px;\\n}\\n.example-headers-align .mat-expansion-panel-header-title,\\n.example-headers-align .mat-expansion-panel-header-description {\\n  flex-basis: 0;\\n}\\n.example-headers-align .mat-expansion-panel-header-description {\\n  justify-content: space-between;\\n  align-items: center;\\n}\\n.example-headers-align .mat-form-field + .mat-form-field {\\n  margin-left: 8px;\\n}\\n.fee-error {\\n  color: gray;\\n  font-size: 0.85em;\\n  margin-bottom: 0.2em;\\n  padding: 0.4em;\\n  border-radius: 5px;\\n}\\n.send-error {\\n  border: 1px solid #5c0000;\\n  background-color: #290000;\\n  color: #ed7575;\\n  margin-bottom: 0.8em;\\n  padding: 0.4em;\\n  border-radius: 5px;\\n}\"],\n    encapsulation: 2\n  });\n}","map":null,"metadata":{},"sourceType":"module"}