{"ast":null,"code":"import _classCallCheck from \"D:\\\\Github\\\\Miladsoft\\\\blockcore-hub-1\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"D:\\\\Github\\\\Miladsoft\\\\blockcore-hub-1\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport _regeneratorRuntime from \"D:\\\\Github\\\\Miladsoft\\\\blockcore-hub-1\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport { __awaiter } from \"tslib\";\nimport { HubAddComponent } from './hub-add.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/global.service\";\nimport * as i2 from \"../../services/api.service\";\nimport * as i3 from \"src/app/services/application-state.service\";\nimport * as i4 from \"src/app/services/chain.service\";\nimport * as i5 from \"src/app/services/settings.service\";\nimport * as i6 from \"src/app/services/hub.service\";\nimport * as i7 from \"src/app/services/identity.service\";\nimport * as i8 from \"@angular/router\";\nimport * as i9 from \"@angular/material/dialog\";\nimport * as i10 from \"../../services/wallet.service\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"@angular/material/icon\";\nimport * as i13 from \"@angular/material/list\";\nimport * as i14 from \"@angular/common\";\nimport * as i15 from \"@angular/material/core\";\nimport * as i16 from \"@angular/material/menu\";\nimport * as i17 from \"@angular/material/divider\";\n\nfunction HubDetailsComponent_mat_list_item_7_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-list-item\");\n    i0.ɵɵelement(1, \"img\", 6);\n    i0.ɵɵelementStart(2, \"h4\", 7);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 7);\n    i0.ɵɵtext(5, \"ID: \");\n    i0.ɵɵelementStart(6, \"a\", 8);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"p\", 9);\n    i0.ɵɵtext(9, \"URL: \");\n    i0.ɵɵelementStart(10, \"a\", 8);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"p\", 9);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\")(15, \"button\", 10)(16, \"mat-icon\");\n    i0.ɵɵtext(17, \"more_vert\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"mat-menu\", null, 11)(20, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function HubDetailsComponent_mat_list_item_7_Template_button_click_20_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r4);\n      var hub_r1 = restoredCtx.$implicit;\n      var ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.removeHub(hub_r1.content.identifier);\n    });\n    i0.ɵɵelementStart(21, \"mat-icon\");\n    i0.ɵɵtext(22, \"delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"span\");\n    i0.ɵɵtext(24, \"Remove hub\");\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    var hub_r1 = ctx.$implicit;\n\n    var _r2 = i0.ɵɵreference(19);\n\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r0.identityService.getImage(hub_r1.content.image), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", hub_r1.content.name, \" (\", hub_r1.originalUrl, \")\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"https://identity.city-chain.org/view/\", hub_r1.content.identifier, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(hub_r1.content.identifier);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"href\", hub_r1.content.url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(hub_r1.content.url);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Status: \", hub_r1.status, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"matMenuTriggerFor\", _r2);\n  }\n}\n\nexport var HubDetailsComponent = /*#__PURE__*/(function () {\n  var HubDetailsComponent = /*#__PURE__*/function () {\n    function HubDetailsComponent(globalService, apiService, cd, appState, chains, settings, hubService, identityService, router, dialog, walletService) {\n      _classCallCheck(this, HubDetailsComponent);\n\n      this.globalService = globalService;\n      this.apiService = apiService;\n      this.cd = cd;\n      this.appState = appState;\n      this.chains = chains;\n      this.settings = settings;\n      this.hubService = hubService;\n      this.identityService = identityService;\n      this.router = router;\n      this.dialog = dialog;\n      this.walletService = walletService;\n      this.hostClass = true;\n      this.columns = 4;\n      this.gridByBreakpoint = {\n        xl: 8,\n        lg: 6,\n        md: 4,\n        sm: 2,\n        xs: 1\n      };\n      this.chain = this.chains.getChain(this.appState.daemon.network);\n    }\n\n    _createClass(HubDetailsComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        var _this = this;\n\n        // Check if the hubs are online every 60 seconds.\n        setInterval(function () {\n          // eslint-disable-next-line @typescript-eslint/prefer-for-of\n          for (var i = 0; i < _this.hubService.hubs.length; i++) {\n            _this.hubService.add(_this.hubService.hubs[i].originalUrl);\n          }\n        }, 60000);\n      }\n    }, {\n      key: \"ngOnDestroy\",\n      value: function ngOnDestroy() {// this.subscription.unsubscribe();\n      }\n    }, {\n      key: \"addHub\",\n      value: function addHub() {\n        return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var _this2 = this;\n\n          var dialogRef;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  dialogRef = this.dialog.open(HubAddComponent, {\n                    width: '300px',\n                    data: {\n                      url: ''\n                    }\n                  });\n                  dialogRef.afterClosed().subscribe(function (result) {\n                    console.log('The dialog was closed', result);\n\n                    if (result) {\n                      console.log('RESULT:', result);\n\n                      _this2.hubService.add(result).then(function (data) {\n                        // Update the local list of hubs with the one persisted in settings.\n                        // this.hubService.hubs = this.settings.hubs;\n                        _this2.cd.markForCheck();\n                      });\n                    }\n                  });\n\n                case 2:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n      }\n    }, {\n      key: \"removeHub\",\n      value: function removeHub(id) {\n        console.log('Trying to remove:' + id);\n        this.hubService.remove(id); // this.hubs = this.settings.hubs;\n\n        this.cd.markForCheck();\n      }\n    }, {\n      key: \"back\",\n      value: function back() {\n        this.router.navigateByUrl('/settings');\n      }\n    }]);\n\n    return HubDetailsComponent;\n  }();\n\n  HubDetailsComponent.ɵfac = function HubDetailsComponent_Factory(t) {\n    return new (t || HubDetailsComponent)(i0.ɵɵdirectiveInject(i1.GlobalService), i0.ɵɵdirectiveInject(i2.ApiService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i3.ApplicationStateService), i0.ɵɵdirectiveInject(i4.ChainService), i0.ɵɵdirectiveInject(i5.SettingsService), i0.ɵɵdirectiveInject(i6.HubService), i0.ɵɵdirectiveInject(i7.IdentityService), i0.ɵɵdirectiveInject(i8.Router), i0.ɵɵdirectiveInject(i9.MatDialog), i0.ɵɵdirectiveInject(i10.WalletService));\n  };\n\n  HubDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HubDetailsComponent,\n    selectors: [[\"app-hub-details\"]],\n    hostVars: 2,\n    hostBindings: function HubDetailsComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        i0.ɵɵclassProp(\"network\", ctx.hostClass);\n      }\n    },\n    decls: 13,\n    vars: 1,\n    consts: [[1, \"details-content\"], [\"mat-mini-fab\", \"\", 1, \"add-node\", 3, \"click\"], [\"mat-subheader\", \"\"], [4, \"ngFor\", \"ngForOf\"], [1, \"network-details-footer\"], [\"mat-raised-button\", \"\", 3, \"click\"], [\"mat-list-avatar\", \"\", 3, \"src\"], [\"mat-line\", \"\"], [\"target\", \"_blank\", 3, \"href\"], [\"mat-line\", \"\", 1, \"mat-card-subtitle\"], [\"mat-icon-button\", \"\", \"aria-label\", \"Example icon-button with a menu\", 3, \"matMenuTriggerFor\"], [\"menu\", \"matMenu\"], [\"mat-menu-item\", \"\", 3, \"click\"]],\n    template: function HubDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function HubDetailsComponent_Template_button_click_1_listener() {\n          return ctx.addHub();\n        });\n        i0.ɵɵelementStart(2, \"mat-icon\");\n        i0.ɵɵtext(3, \"add\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"mat-list\")(5, \"h3\", 2);\n        i0.ɵɵtext(6, \"Hubs\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(7, HubDetailsComponent_mat_list_item_7_Template, 25, 9, \"mat-list-item\", 3);\n        i0.ɵɵelement(8, \"mat-divider\")(9, \"br\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"div\", 4)(11, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function HubDetailsComponent_Template_button_click_11_listener() {\n          return ctx.back();\n        });\n        i0.ɵɵtext(12, \"Go back\");\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.hubService.hubs);\n      }\n    },\n    directives: [i11.MatButton, i12.MatIcon, i13.MatList, i13.MatListSubheaderCssMatStyler, i14.NgForOf, i13.MatListItem, i13.MatListAvatarCssMatStyler, i15.MatLine, i16.MatMenuTrigger, i16.MatMenu, i16.MatMenuItem, i17.MatDivider],\n    styles: [\".network .mat-list-avatar{min-width:80px!important;min-height:80px!important;width:80px!important;height:80px!important}.network .add-node{float:right;margin-right:18px;margin-top:4px}.network .card{margin:0 20px 20px}.network .details-content{margin-top:14px}.network .network-grid{border-bottom:1px solid silver}.network .network-details-footer{text-align:center;padding-top:20px;padding-bottom:20px}.network .network-label{color:gray;padding-bottom:10px}.network .network-value{font-size:1.6em}.network .mat-grid-tile .mat-figure{flex-direction:column!important}.network .mat-grid-tile{border-right:1px solid silver!important;border-bottom:1px solid silver!important}.network .network-grid>.mat-grid-title{border-right:1px solid silver!important;border-bottom:1px solid silver!important}.network .network-grid .mat-icon{font-size:1.6em!important}\\n\"],\n    encapsulation: 2\n  });\n  return HubDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}