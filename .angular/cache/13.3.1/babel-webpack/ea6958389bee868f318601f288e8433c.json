{"ast":null,"code":"// OP_RETURN {aa21a9ed} {commitment}\nvar Buffer = require('safe-buffer').Buffer;\n\nvar bscript = require('../../script');\n\nvar types = require('../../types');\n\nvar typeforce = require('typeforce');\n\nvar OPS = require('bitcoin-ops');\n\nvar HEADER = Buffer.from('aa21a9ed', 'hex');\n\nfunction check(script) {\n  var buffer = bscript.compile(script);\n  return buffer.length > 37 && buffer[0] === OPS.OP_RETURN && buffer[1] === 0x24 && buffer.slice(2, 6).equals(HEADER);\n}\n\ncheck.toJSON = function () {\n  return 'Witness commitment output';\n};\n\nfunction encode(commitment) {\n  typeforce(types.Hash256bit, commitment);\n  var buffer = Buffer.allocUnsafe(36);\n  HEADER.copy(buffer, 0);\n  commitment.copy(buffer, 4);\n  return bscript.compile([OPS.OP_RETURN, buffer]);\n}\n\nfunction decode(buffer) {\n  typeforce(check, buffer);\n  return bscript.decompile(buffer)[1].slice(4, 36);\n}\n\nmodule.exports = {\n  check: check,\n  decode: decode,\n  encode: encode\n};","map":null,"metadata":{},"sourceType":"script"}